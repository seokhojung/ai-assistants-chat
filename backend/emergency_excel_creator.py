#!/usr/bin/env python3
"""
긴급 Excel 파일 복구 스크립트
삭제된 Excel 파일들을 재생성합니다
"""

import pandas as pd
import os
from datetime import datetime, timedelta
import random

def create_directories():
    """필요한 디렉토리 생성"""
    directories = [
        "app/data/excel/members",
        "app/data/excel/staff", 
        "app/data/excel/hr",
        "app/data/excel/inventory"
    ]
    
    for directory in directories:
        os.makedirs(directory, exist_ok=True)
        print(f"✅ 디렉토리 생성: {directory}")

def create_members_excel():
    """회원관리 Excel 파일 생성"""
    # 샘플 회원 데이터
    members_data = [
        {
            "회원번호": 1, "이름": "김철수", "나이": 28, "성별": "남",
            "전화번호": "010-1234-5678", "이메일": "kim@email.com",
            "주소": "서울시 강남구", "직업": "회사원",
            "멤버십타입": "프리미엄", "월회비": 150000,
            "가입일": "2024-01-15", "만료일": "2025-01-15",
            "결제상태": "완료", "비상연락처": "010-1234-9999",
            "특이사항": "없음"
        },
        {
            "회원번호": 2, "이름": "이영희", "나이": 25, "성별": "여",
            "전화번호": "010-2345-6789", "이메일": "lee@email.com", 
            "주소": "서울시 서초구", "직업": "디자이너",
            "멤버십타입": "일반", "월회비": 80000,
            "가입일": "2024-02-01", "만료일": "2025-02-01",
            "결제상태": "완료", "비상연락처": "010-2345-9999",
            "특이사항": "없음"
        },
        {
            "회원번호": 3, "이름": "박민수", "나이": 32, "성별": "남",
            "전화번호": "010-3456-7890", "이메일": "park@email.com",
            "주소": "서울시 마포구", "직업": "개발자", 
            "멤버십타입": "VIP", "월회비": 200000,
            "가입일": "2024-03-10", "만료일": "2025-03-10",
            "결제상태": "완료", "비상연락처": "010-3456-9999",
            "특이사항": "개인 트레이너 희망"
        },
        {
            "회원번호": 4, "이름": "최수진", "나이": 29, "성별": "여",
            "전화번호": "010-4567-8901", "이메일": "choi@email.com",
            "주소": "서울시 송파구", "직업": "간호사",
            "멤버십타입": "일반", "월회비": 80000,
            "가입일": "2024-04-05", "만료일": "2025-04-05", 
            "결제상태": "완료", "비상연락처": "010-4567-9999",
            "특이사항": "야간 운동 선호"
        },
        {
            "회원번호": 5, "이름": "정대호", "나이": 35, "성별": "남",
            "전화번호": "010-5678-9012", "이메일": "jung@email.com",
            "주소": "서울시 종로구", "직업": "교사",
            "멤버십타입": "프리미엄", "월회비": 150000,
            "가입일": "2024-05-20", "만료일": "2025-05-20",
            "결제상태": "완료", "비상연락처": "010-5678-9999", 
            "특이사항": "주말 운동"
        }
    ]
    
    # 통계 데이터
    stats_data = [
        {"항목": "총회원수", "값": 5},
        {"항목": "활성회원", "값": 5},
        {"항목": "프리미엄", "값": 2},
        {"항목": "일반", "값": 2},
        {"항목": "VIP", "값": 1},
        {"항목": "남성", "값": 3},
        {"항목": "여성", "값": 2},
        {"항목": "총월매출", "값": 660000}
    ]
    
    # Excel 파일 생성
    file_path = "app/data/excel/members/회원관리_20250624.xlsx"
    with pd.ExcelWriter(file_path, engine='openpyxl') as writer:
        pd.DataFrame(members_data).to_excel(writer, sheet_name='회원목록', index=False)
        pd.DataFrame(stats_data).to_excel(writer, sheet_name='통계', index=False)
    
    print(f"✅ 회원관리 Excel 파일 생성: {file_path}")

def create_staff_excel():
    """직원관리 Excel 파일 생성"""
    staff_data = [
        {
            "직원번호": 1, "이름": "김트레이너", "나이": 30, "성별": "남",
            "전화번호": "010-1111-2222", "이메일": "trainer1@gym.com",
            "직책": "헤드트레이너", "부서": "운동지도팀",
            "월급여": 3500000, "입사일": "2023-01-01",
            "근무상태": "활성", "자격증": "생활스포츠지도사",
            "특이사항": "10년 경력"
        },
        {
            "직원번호": 2, "이름": "이매니저", "나이": 28, "성별": "여", 
            "전화번호": "010-2222-3333", "이메일": "manager@gym.com",
            "직책": "매니저", "부서": "운영팀",
            "월급여": 3000000, "입사일": "2023-03-15",
            "근무상태": "활성", "자격증": "경영학사",
            "특이사항": "회원 관리 전담"
        },
        {
            "직원번호": 3, "이름": "박청소", "나이": 45, "성별": "여",
            "전화번호": "010-3333-4444", "이메일": "cleaning@gym.com",
            "직책": "청소원", "부서": "시설관리팀", 
            "월급여": 2200000, "입사일": "2023-06-01",
            "근무상태": "활성", "자격증": "없음",
            "특이사항": "야간 근무"
        }
    ]
    
    file_path = "app/data/excel/staff/직원관리_20250624.xlsx"
    pd.DataFrame(staff_data).to_excel(file_path, index=False)
    print(f"✅ 직원관리 Excel 파일 생성: {file_path}")

def create_inventory_excel():
    """재고관리 Excel 파일 생성"""
    inventory_data = [
        {
            "품목번호": 1, "품목명": "프로틴 파우더", "카테고리": "보충제",
            "현재재고": 50, "최소재고": 20, "최대재고": 100,
            "단가": 45000, "공급업체": "헬스코리아",
            "입고일": "2024-06-15", "유통기한": "2025-06-15",
            "위치": "창고A-1", "상태": "정상"
        },
        {
            "품목번호": 2, "품목명": "운동타올", "카테고리": "용품",
            "현재재고": 30, "최소재고": 50, "최대재고": 200,
            "단가": 8000, "공급업체": "타올월드",
            "입고일": "2024-06-10", "유통기한": "",
            "위치": "창고B-2", "상태": "부족"
        },
        {
            "품목번호": 3, "품목명": "물통", "카테고리": "용품",
            "현재재고": 80, "최소재고": 30, "최대재고": 150,
            "단가": 12000, "공급업체": "스포츠용품사",
            "입고일": "2024-06-01", "유통기한": "",
            "위치": "창고B-1", "상태": "정상"
        },
        {
            "품목번호": 4, "품목명": "BCAA", "카테고리": "보충제",
            "현재재고": 25, "최소재고": 15, "최대재고": 80,
            "단가": 35000, "공급업체": "헬스코리아",
            "입고일": "2024-06-20", "유통기한": "2025-12-20",
            "위치": "창고A-2", "상태": "정상"
        },
        {
            "품목번호": 5, "품목명": "운동장갑", "카테고리": "용품",
            "현재재고": 15, "최소재고": 25, "최대재고": 100,
            "단가": 15000, "공급업체": "스포츠용품사",
            "입고일": "2024-05-30", "유통기한": "",
            "위치": "창고B-3", "상태": "부족"
        }
    ]
    
    file_path = "app/data/excel/inventory/재고관리_20250624.xlsx"
    pd.DataFrame(inventory_data).to_excel(file_path, index=False)
    print(f"✅ 재고관리 Excel 파일 생성: {file_path}")

def create_hr_excel():
    """인사관리 Excel 파일 생성"""
    hr_data = [
        {
            "직원번호": 1, "이름": "김트레이너", "부서": "운동지도팀",
            "연차사용": 5, "총연차": 15, "잔여연차": 10,
            "월근무시간": 160, "초과근무": 20, "야간근무": 0,
            "평가점수": 95, "상벌내역": "우수직원상", "교육이수": "응급처치교육"
        },
        {
            "직원번호": 2, "이름": "이매니저", "부서": "운영팀",
            "연차사용": 8, "총연차": 15, "잔여연차": 7,
            "월근무시간": 170, "초과근무": 30, "야간근무": 10,
            "평가점수": 88, "상벌내역": "없음", "교육이수": "고객서비스교육"
        },
        {
            "직원번호": 3, "이름": "박청소", "부서": "시설관리팀",
            "연차사용": 3, "총연차": 15, "잔여연차": 12,
            "월근무시간": 160, "초과근무": 0, "야간근무": 80,
            "평가점수": 82, "상벌내역": "성실근무상", "교육이수": "안전교육"
        }
    ]
    
    file_path = "app/data/excel/hr/인사관리_20250624.xlsx"
    pd.DataFrame(hr_data).to_excel(file_path, index=False)
    print(f"✅ 인사관리 Excel 파일 생성: {file_path}")

def main():
    """메인 실행 함수"""
    print("🚨 긴급 Excel 파일 복구 시작!")
    print("=" * 50)
    
    # 1. 디렉토리 생성
    create_directories()
    
    # 2. Excel 파일들 생성
    create_members_excel()
    create_staff_excel() 
    create_inventory_excel()
    create_hr_excel()
    
    print("=" * 50)
    print("✅ 긴급 복구 완료!")
    print("🎯 모든 Excel 파일이 재생성되었습니다!")

if __name__ == "__main__":
    main() 